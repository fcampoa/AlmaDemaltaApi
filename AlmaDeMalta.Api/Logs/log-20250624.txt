2025-06-24 11:47:23.963 -07:00 [INF] Registered 21 endpoints in 823 milliseconds.
2025-06-24 11:53:46.544 -07:00 [INF] Registered 21 endpoints in 771 milliseconds.
2025-06-24 11:59:25.501 -07:00 [ERR] An unhandled exception occurred.
System.FormatException: An error occurred while deserializing the PurchaseOrderNumber property of class AlmaDeMalta.Common.Contracts.Contracts.Sale: Cannot deserialize a 'String' from BsonType 'Document'.
 ---> System.FormatException: Cannot deserialize a 'String' from BsonType 'Document'.
   at MongoDB.Bson.Serialization.Serializers.StringSerializer.DeserializeValue(BsonDeserializationContext context, BsonDeserializationArgs args)
   at MongoDB.Bson.Serialization.Serializers.SealedClassSerializerBase`1.Deserialize(BsonDeserializationContext context, BsonDeserializationArgs args)
   at MongoDB.Bson.Serialization.Serializers.SerializerBase`1.MongoDB.Bson.Serialization.IBsonSerializer.Deserialize(BsonDeserializationContext context, BsonDeserializationArgs args)
   at MongoDB.Bson.Serialization.IBsonSerializerExtensions.Deserialize(IBsonSerializer serializer, BsonDeserializationContext context)
   at MongoDB.Bson.Serialization.BsonClassMapSerializer`1.DeserializeMemberValue(BsonDeserializationContext context, BsonMemberMap memberMap)
   --- End of inner exception stack trace ---
   at MongoDB.Bson.Serialization.BsonClassMapSerializer`1.DeserializeMemberValue(BsonDeserializationContext context, BsonMemberMap memberMap)
   at MongoDB.Bson.Serialization.BsonClassMapSerializer`1.DeserializeClass(BsonDeserializationContext context)
   at MongoDB.Bson.Serialization.BsonClassMapSerializer`1.Deserialize(BsonDeserializationContext context, BsonDeserializationArgs args)
   at MongoDB.Bson.Serialization.IBsonSerializerExtensions.Deserialize[TValue](IBsonSerializer`1 serializer, BsonDeserializationContext context)
   at MongoDB.Driver.Core.Operations.CursorBatchDeserializationHelper.DeserializeBatch[TDocument](RawBsonArray batch, IBsonSerializer`1 documentSerializer, MessageEncoderSettings messageEncoderSettings)
   at MongoDB.Driver.Core.Operations.FindOperation`1.CreateFirstCursorBatch(BsonDocument cursorDocument)
   at MongoDB.Driver.Core.Operations.FindOperation`1.CreateCursor(IChannelSourceHandle channelSource, IChannelHandle channel, BsonDocument commandResult)
   at MongoDB.Driver.Core.Operations.FindOperation`1.ExecuteAsync(RetryableReadContext context, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.FindOperation`1.ExecuteAsync(IReadBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteReadOperationAsync[TResult](IReadBinding binding, IReadOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteReadOperationAsync[TResult](IClientSessionHandle session, IReadOperation`1 operation, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at MongoDB.Driver.IAsyncCursorSourceExtensions.ToListAsync[TDocument](IAsyncCursorSource`1 source, CancellationToken cancellationToken)
   at AlmaDeMalta.Common.Contracts.DataBase.MongoDbContext.Filter[T](Expression`1 filter) in C:\Users\felix\repos\AlmaDeMaltaBack\Common\AlmaDeMalta.Common.Contracts\DataBase\MongoDbContext.cs:line 39
   at AlmaDeMalta.Common.Contracts.Repositories.RepositoryBase`1.GetAsync(Expression`1 filter) in C:\Users\felix\repos\AlmaDeMaltaBack\Common\AlmaDeMalta.Common.Contracts\Repositories\RepositoryBase.cs:line 37
   at AlmaDeMalta.api.Services.Impl.SaleService.GetAllAsync() in C:\Users\felix\repos\AlmaDeMaltaBack\Api\AlmaDeMalta.Api\Services\Impl\SaleService.cs:line 52
   at AlmaDeMalta.api.Endpoints.Sales.GetSalesEndpoint.HandleAsync(CancellationToken ct) in C:\Users\felix\repos\AlmaDeMaltaBack\Api\AlmaDeMalta.Api\Endpoints\Sales\GetSalesEndpoint.cs:line 21
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at AlmaDeMalta.api.Middlewares.ExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\felix\repos\AlmaDeMaltaBack\Api\AlmaDeMalta.Api\Middlewares\ExceptionHandlerMiddleware.cs:line 18
2025-06-24 11:59:26.985 -07:00 [INF] Retrieved 1 sales from the database.
2025-06-24 11:59:39.052 -07:00 [INF] Retrieved 1 sales from the database.
2025-06-24 11:59:55.447 -07:00 [INF] Retrieved 1 sales from the database.
2025-06-24 12:01:02.112 -07:00 [INF] Retrieved 1 sales from the database.
2025-06-24 12:49:01.701 -07:00 [INF] Retrieved 1 sales from the database.
2025-06-24 12:58:21.250 -07:00 [INF] Retrieved 1 sales from the database.
2025-06-24 13:01:18.005 -07:00 [ERR] An unhandled exception occurred.
System.Collections.Generic.KeyNotFoundException: The given key 'AlmaDeMalta.Common.Contracts.Contracts.SaleDashboard' was not present in the dictionary.
   at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at AlmaDeMalta.Common.Contracts.DataBase.MongoDbContext.GetMongoCollection[T]() in C:\Users\felix\repos\AlmaDeMaltaBack\Common\AlmaDeMalta.Common.Contracts\DataBase\MongoDbContext.cs:line 122
   at AlmaDeMalta.Common.Contracts.DataBase.MongoDbContext.Filter[T](Expression`1 filter) in C:\Users\felix\repos\AlmaDeMaltaBack\Common\AlmaDeMalta.Common.Contracts\DataBase\MongoDbContext.cs:line 39
   at AlmaDeMalta.Common.Contracts.Repositories.RepositoryBase`1.GetAsync(Expression`1 filter) in C:\Users\felix\repos\AlmaDeMaltaBack\Common\AlmaDeMalta.Common.Contracts\Repositories\RepositoryBase.cs:line 37
   at AlmaDeMalta.api.Services.Impl.SaleDashboardService.GetAllAsync() in C:\Users\felix\repos\AlmaDeMaltaBack\Api\AlmaDeMalta.Api\Services\Impl\SaleDashboardService.cs:line 50
   at AlmaDeMalta.api.Endpoints.Sales.Dashboard.GetSaleDashboardsEndpoint.HandleAsync(CancellationToken ct) in C:\Users\felix\repos\AlmaDeMaltaBack\Api\AlmaDeMalta.Api\Endpoints\Sales\Dashboard\GetSaleDashboardsEndpoint.cs:line 22
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at AlmaDeMalta.api.Middlewares.ExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\felix\repos\AlmaDeMaltaBack\Api\AlmaDeMalta.Api\Middlewares\ExceptionHandlerMiddleware.cs:line 18
2025-06-24 13:01:26.136 -07:00 [INF] Retrieved 2 payment methods from the database.
2025-06-24 13:01:39.976 -07:00 [INF] Retrieved 2 dashboards from the database.
2025-06-24 13:01:39.990 -07:00 [INF] Retrieved 2 payment methods from the database.
2025-06-24 13:01:50.315 -07:00 [INF] Dashboard retrieved with ID: 6889049e-3304-483d-b822-917272262815
2025-06-24 13:38:35.260 -07:00 [INF] Retrieved 2 dashboards from the database.
2025-06-24 13:38:35.260 -07:00 [INF] Retrieved 2 payment methods from the database.
2025-06-24 13:38:46.022 -07:00 [INF] Dashboard retrieved with ID: 6889049e-3304-483d-b822-917272262815
2025-06-24 14:00:07.075 -07:00 [INF] Sale created with ID: 9b3aa47f-98a1-449c-80d6-137fe6b1c9a1
2025-06-24 14:00:40.231 -07:00 [INF] Sale created with ID: de747ab0-ba31-4b17-bfba-c7ecefa671ee
